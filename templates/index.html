<!DOCTYPE html>
<html data-wf-page="61f926855c6753e13bf998eb" data-wf-site="61b48543ef9d402652170654">
<head>
  <meta charset="utf-8">
  <title>COMP390 PSA project</title>
  <meta content="The Final Year Project made @ The University of Liverpool." name="description">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="static/css/normalize.css" rel="stylesheet" type="text/css">
  <link href="static/css/webflow.css" rel="stylesheet" type="text/css">
  <link href="static/css/fyp-bdc887.webflow.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script src="https://kit.fontawesome.com/0d7d3f0842.js" crossorigin="anonymous"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Vollkorn:400,400italic,700,700italic","Roboto Condensed:300,regular,700","Roboto:300,regular,500"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="static/images/bot.png" rel="shortcut icon" type="image/x-icon">
  <link href="static/images/bot.png" rel="apple-touch-icon">
</head>
<body class="body">
  <div data-collapse="medium" data-animation="default" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav">
    <div class="w-container">
      <a href="/" aria-current="page" class="brand w-clearfix w-nav-brand w--current"><img src="static/images/bot.png" width="20" alt="" class="stone-logo">
        <div class="logo-text">PSA</div>
      </a>
      <nav role="navigation" class="nav-menu w-nav-menu">
        <a href="#Section0" class="nav-link w-nav-link">Reddit Crawing</a>
        <a href="#Cross-Checking" class="nav-link w-nav-link">Cross Party</a>
        <a href="#Prediction" class="nav-link w-nav-link">prediction</a>
        <a href="#" class="nav-link w-hidden-main w-hidden-medium w-hidden-small w-hidden-tiny w-nav-link">Facebook</a>
        <a href="#" class="nav-link w-hidden-main w-hidden-medium w-hidden-small w-hidden-tiny w-nav-link">Twitter</a>
      </nav>
      <div class="menu-button w-nav-button">
        <div class="menu-icon w-icon-nav-menu"></div>
      </div>
    </div>
  </div>
  <div data-delay="4000" data-animation="over" class="slider w-slider" data-autoplay="true" data-easing="ease" data-hide-arrows="false" data-disable-swipe="false" data-autoplay-limit="0" data-nav-spacing="3" data-duration="500" data-infinite="true">
    <div class="mask w-slider-mask">
      <div id="home" class="slide w-slide">
        <div class="w-container">
          <h1 class="main-heading">Political Sentiment</h1>
          <h1 class="main-heading bold">Analysis</h1>
          <div class="horizontal-bar"></div>
          <div class="main-subheading">Honours Year Project @ University of Liverpool</div>
        </div>
      </div>
      <div class="slide _2 w-slide">
        <div class="w-container">
          <h1 class="main-heading">about</h1>
          <p class="slide2">The aim of this project is to use data mining, natural language processing and machine learning
              to examine public comments for sentiment over longer periods of time.
              The majority of the data used in this project is trawled anonymously from <a href="https://www.reddit.com/"><i class="fa-brands fa-reddit" style='font-size:36px'></i></a> using a reddit bot.
              The website currently supports subreddit content crawling; Cross party comment validation; Keyword extraction and
              political sentiment prediction(English and Simplified Chinese).
              Check out my GitHub page for more information. </p>
          <div class="horizontal-bar"></div>
          <a class='github-link' href="https://github.com/CharlieZJG/Political-Sentiment-Analysis"><i class="fab fa-github" style='font-size:36px'></i></a>

        </div>
      </div>
    </div>
    <div class="slider-nav w-slider-nav"></div>
  </div>
  <div id="Section0" class="section0 wf-section">
    <div class="w-container">
      <h1 class="heading-11">SUBREDDIT CRAWLING</h1>
    </div>
  </div>
  <div class="section-11 beige wf-section">
    <div class="w-container">
      <div class="w-row">
        <div class="column w-col w-col-6">
          <a id='democrats-a' href="#" class="link-block w-inline-block">
              <img id='democrats-img' class="image-4" src="static/images/democrat1.png" width="300" height="300" alt="" sizes="(max-width: 479px) 83vw, 300px" data-w-id="792e3de7-ee19-be5a-d578-1a36ee7415e4" loading="lazy" srcset="/static/images/democrat1-p-800.png 800w, /static/images/democrat1-p-1080.png 1080w, /static/images/democrat1.png 1280w">
          </a>
        </div>
        <div class="w-col w-col-6">
          <a id='republican-a' href="#" class="link-block-2 w-inline-block">
              <img id='republican-img' class="image-5" src="static/images/republican1.png" width="300" height="300" alt="" sizes="(max-width: 479px) 83vw, (max-width: 767px) 300px, (max-width: 991px) 264px, 300px" data-w-id="1c0cb4c7-0d2e-eff0-9202-86fc256a10bf" loading="lazy" srcset="static/images/republican1-p-500.png 500w, static/images/republican1-p-800.png 800w, static/images/republican1-p-1080.png 1080w, static/images/republican1-p-1600.png 1600w, static/images/republican1.png 1920w"></a>
        </div>
      </div>
    </div>
  </div>
  <div id='subreddit-selection1' data-w-id="260b3b91-f61f-702f-3f75-2fe81dfc561d" style="display:none" class="section-2 wf-section">
    <div  class="w-container">
      <div id="blue-topic" class="w-layout-grid grid">
        <h4 id="Pro-Choice-id" class="heading-6">Pro-Choice</h4>
        <h4 id="Anti-Gun-id">Anti-Gun</h4>
        <a href="#topic-data-crawling" onclick="changeTextarea('prochoice');return false;" id='prochoice'  class="link-block-7 w-inline-block"><img src="static/images/path.png" loading="lazy" width="170" height="170" srcset="static/images/path-p-500.png 500w, /static/images/path.png 512w" sizes="170px" alt=""></a>
        <a href="#topic-data-crawling" onclick="changeTextarea('guncontrol');return false;" id='guncontrol' class="link-block-8 w-inline-block"><img src="static/images/no-weapons.png" loading="lazy" width="170" height="170" srcset="static/images/no-weapons-p-500.png 500w, /static/images/no-weapons.png 512w" sizes="170px" alt=""></a>
        <h4 id="Pro-Immigration-id">Pro-Immigration</h4>
        <h4 id="Pro-Vaccine-id">Pro-Vaccine</h4>
        <a href="#topic-data-crawling" onclick="changeTextarea('immigration');return false;" id='immigration' class="link-block-5 w-inline-block"><img src="static/images/passport.png" loading="lazy" width="170" height="170" srcset="static/images/passport-p-500.png 500w, static/images/passport.png 512w" sizes="170px" alt=""></a>
        <a href="#topic-data-crawling" onclick="changeTextarea('vaxxhappened');return false;" id='vaxxhappened' class="link-block-6 w-inline-block"><img src="static/images/vaccine.png" loading="lazy" width="170" height="170" alt="" class="image-6-copy"></a>
      </div>
    </div>
  </div>
  <div id='subreddit-selection2' data-w-id="aa5eb609-0ca4-d7e4-ec0b-af45785334bd" style="display:none" class="section-3 wf-section">
    <div  class="w-container">
      <div id="red-topic" class="w-layout-grid grid">
        <h4 id="Immigration-Reform-id">Immigration-Reform</h4>
        <h4 id="Pro-Life-id" class="heading-6">Pro-Life</h4>
        <a href="#topic-data-crawling" onclick="changeTextarea('ImmigrationReform');return false;" id='ImmigrationReform' class="link-block-5 w-inline-block"><img src="static/images/illegal.png" loading="lazy" width="170" height="170" srcset="static/images/illegal-p-500.png 500w, static/images/illegal.png 512w" sizes="170px" alt=""></a>
        <a href="#topic-data-crawling" onclick="changeTextarea('prolife');return false;" id='prolife' class="link-block-9 w-inline-block"><img src="static/images/embryo.png" loading="lazy" width="170" height="170" srcset="static/images/embryo-p-500.png 500w, static/images/embryo.png 512w" sizes="170px" alt="" class="image-6-copy"></a>
        <h4 id="Anti-Vaccine-id">Anti-Vaccine</h4>
        <h4 id="Pro-Gun-id">Pro-Gun</h4>
        <a href="#topic-data-crawling" onclick="changeTextarea('antivaccine');return false;" id='antivaccine' class="link-block-6 w-inline-block"><img src="static/images/no-vaccines.png" loading="lazy" width="170" height="170" alt="" class="image-6-copy"></a>
        <a href="#topic-data-crawling" onclick="changeTextarea('progun');return false;" id='progun' class="link-block-10 w-inline-block"><img src="static/images/gun.png" loading="lazy" width="170" height="170" alt="" class="image-6-copy"></a>
      </div>
    </div>
  </div>
  <div id="topic-data-crawling" class="section-10 wf-section">
    <div class="w-container">
      <div class="w-row">
        <div class="w-col w-col-8"><img src="static/images/pexels-philippe-donn-1242764.jpg" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 478.65625px, 619.984375px" srcset="static/images/pexels-philippe-donn-1242764-p-800.jpeg 800w, static/images/pexels-philippe-donn-1242764-p-1080.jpeg 1080w, static/images/pexels-philippe-donn-1242764-p-1600.jpeg 1600w, static/images/pexels-philippe-donn-1242764-p-2000.jpeg 2000w, static/images/pexels-philippe-donn-1242764-p-2600.jpeg 2600w, static/images/pexels-philippe-donn-1242764-p-3200.jpeg 3200w, static/images/pexels-philippe-donn-1242764.jpg 4924w" alt="" class="side-image"></div>
        <div class="w-col w-col-4">
          <!--  topic data crawling form   -->
          <div class="w-form">
            <form  id="topic-data-crawling-form-id" name="topic-data-crawling-form" data-name="Email Form 3" method="post" class="form-2">
              <!--  display the selected topic from previous section   -->
              <!-- <div id = 'selected-topic' class="text-block-6">This is supposed to display the selected topic in the previous section</div> -->
              <textarea readonly name ='selected_topic' id='selected-topic' ></textarea>
              <select id="newTopHot-id" name="newTopHot" data-name="newTopHot" required="" class="select-field w-select">
                <option value="New">New</option>
                <option value="Top">Top</option>
                <option value="Hot">Hot</option>
              </select>
              <div class="w-row">
                <div class="w-col w-col-6"><label for="Post-Number" class="field-label-11">Post Number</label>
                    <input type="number" class="w-input" maxlength="256" name="Post-Number" data-name="Post Number" placeholder="5 Maximum" id="Post-Number" required="" min="1" max="5"></div>
                <div class="w-col w-col-6"><label for="Comment-Number" class="field-label-12">Comment Number</label>
                    <input type="number" class="w-input" maxlength="256" name="Comment-Number" data-name="Comment Number" placeholder="10 Maximum" id="Comment-Number" required="" min="1" max="10"></div>
              </div><input type="submit" value="Crawl" data-wait="Please wait..." class="submit-button w-button">
            </form>
            <div class="w-form-done">
              <div>Thank you! Your submission has been received!</div>
            </div>
            <div class="w-form-fail">
              <div>Thank you! Your submission has been received! It takes a few seconds to process it.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--  Receive topic data from the backend   -->
  <div id="sention2-crawled-data" class="section-4 wf-section">
    <div class="w-container">
      <div class="w-row">

        <table id ="s2-crawled-topic-id" class="s2-crawled-topic_table" >
            <tbody id ="s2-crawled-topic-tbody-id">

            </tbody>
        </table>
      </div>
    </div>
         <!--  comment reply section  -->
        <div id = "reply-comment-div-id" class="div_keyword_class" >
            <form id="reply_comment-form-id" method="post" class="form-1_2">
                <label id='head-id' for="reply-Field" class="field-label-3">Replying to comment id:</label>

                <div id="credentials-id">
                <label for="username">Reddit Username:</label>
                <input type="text" autocomplete="off" id="username" name="username">
                <label for="pass">Password:</label>
                <input type="password" autocomplete="off" id="pass" name="password" required>
                 </div>
                 <div id="actual-comment-id">
                    <textarea rows="10" cols="140" id="reply_comment-field-id" type="text" class="text-field w-input" autofocus="true" maxlength="1000" name="reply-Field" data-name="reply Field" placeholder="Enter your reply here" required=""></textarea>
                    <input id="Reply-id" autocomplete="off" type="submit" value="Reply" data-wait="Please wait..." class="submit-button-3 w-button">
                 </div>
            </form>

      </div>
  </div>

  <div class="section-14 wf-section">
    <div class="w-container">
      <h1 id="Cross-Checking" class="heading-12">Cross Checking</h1>
    </div>
  </div>
  <div id="section3" class="section5 wf-section">
    <div class="container-3 w-container">
      <div class="w-form">
        <form  id="cross-checking-form-id" name="wf-form-Cross-Party" data-name="Cross Party" method="post">
            <label for="Topic-Name" class="field-label-8">Select A Political Topic</label>
            <select id="section3-topic-name-id" name="Topic-Name" data-name="Topic Name" required="" class="w-select">
            <option value="vaxxhappened">Pro-Vaccine</option>
            <option value="immigration">Pro-Immigration</option>
            <option value="guncontrol">Anti-Gun</option>
            <option value="prochoice">Pro-Choice</option>
            <option value="antivaccin">Anti-Vaccine</option>
            <option value="ImmigrationReform">Immigration Reform</option>
            <option value="prolife">Pro-Life</option>
            <option value="progun">Pro-Gun</option>
            </select>
            <label for="Political-Party" class="field-label-10">Select A Political Party</label>
            <select id="section3-political-party-id" name="Political-Party" data-name="Political Party" required="" class="w-select">
            <option value="democrats">Democratic</option>
            <option value="Republican">Republican</option>
            <option value="Conservative">Conservative</option>
            <option value="Liberal">Liberal</option>
          </select>
            <!--  Receive cross checking data from the backend   -->
            <input type="submit" value="Cross Check" data-wait="Please wait..." class="submit-button-2 w-button">
        </form>
        <div class="w-form-done">
          <div>Thank you! Your submission has been received!</div>
        </div>
        <div class="w-form-fail">
          <div>Thank you! Your submission has been received! It takes a few seconds to process it.</div>
        </div>
      </div>
    </div>
  </div>
  <div id='section3-cross_checking-id' class="section-13 wf-section">
      <div class="w-container">
        <div id = "pie-chart-div-id" class="w-row" >

        </div>
      </div>
      <div class="w-container">
        <div class="w-row" style="float:right;">
            <table id ="s3-cross-checking-table-id" class="s3-cross-checking-table-id"  >
                <tbody id ="s3-cross-checking-tbody-id">
                </tbody>
            </table>
        </div>
     </div>
      <!--  keyword extraction section  -->
      <div class="w-container">
        <div id = "keyword-div-id" class="div_keyword_class" >
            <p id="keyword1" class="keyword_class"></p>
            <p id="keyword2" class="keyword_class"></p>
            <p id="keyword3" class="keyword_class"></p>
            <p id="keyword4" class="keyword_class"></p>
        </div>
      </div>
  </div>
    <!--  prediction section  -->
  <div class="section-16 wf-section">
    <div class="container-2 w-container">
      <h1 id="Prediction" class="heading-13">Prediction</h1>
    </div>
  </div>
  <div class="wf-section">
    <div class="w-form">
      <form  id="prediction-form-id" name="prediction-form4" data-name="prediction-data-form" method="post" class="form-3">
          <label for="Prediction-Field" class="field-label-3">Comment Prediction</label>
          <select id="language-id" name="language" required=""  class="language-select-class">
                <option value="English">English</option>
                <option value="zh_Chinese">简体中文</option>
          </select>
          <textarea rows="15" cols="70" id="prediction-field-id" type="text" class="text-field w-input" autofocus="true" maxlength="1000" name="Prediction-Field" data-name="Prediction Field" placeholder="Please Enter a political-related speech" required=""></textarea>
          <input id="Analyze and Filter-id" type="submit" value="Analyze and Filter" data-wait="Please wait..." class="submit-button-3 w-button">
      </form>
    </div>

  </div>
  <div id='prediction-result-id' class="section-15 wf-section">
    <div class="w-container">
        <!--  text filtering section  -->
     <div id='text-filtering-id' class="w-row">
              <div class="center">
                <h3>Filtered Text</h3>
                <p id="filtered-text-id" class="keyword_class1"></p>
{#                <div><textarea readonly name ='filtered-text-name' id='filtered-text-id' class='filtered-text-div-class'></textarea></div>#}
              </div>

    </div>
        <hr class="solid">
      <div class="w-row">
          <h3>Text Analysis</h3>
        <div class="w-col w-col-3">
            <h4 class='prediction-class'>Word Length</h4>
            <div><textarea readonly name ='word-length-name' id='length-id' class='prediction-result1-class'></textarea></div>
        </div>
        <div class="w-col w-col-3">
            <h4 class='prediction-class'>People</h4>
            <div><textarea readonly name ='people-name' id='people-id' class='prediction-result1-class'></textarea></div>
        </div>
        <div class="w-col w-col-3">
          <h4 class='prediction-class'>Abusive Snippets</h4>
          <div><textarea readonly name ='Noun-Phrases-name' id='Noun-Phrases-id' class='prediction-result1-class'></textarea></div>
        </div>
        <div class="w-col w-col-3">
          <h4 class='prediction-class'>Abuse Severity</h4>
          <div><textarea readonly name ='hate-severity' id='hate-severity-id' class='prediction-result1-class'></textarea></div>
        </div>
        <div class="w-col w-col-3">
          <h4 class='prediction-class'>Left Score</h4>
          <div><textarea readonly name ='left-score' id='left-score-id' class='prediction-result1-class'></textarea></div>
        </div>
        <div class="w-col w-col-3">
          <h4 class='prediction-class'>Right Score</h4>
          <div><textarea readonly name ='right-score' id='right-score-id' class='prediction-result1-class'></textarea></div>
        </div>

        <div class="w-col w-col-3">
            <h4 class='prediction-class'>Abuse Score</h4>
            <div><textarea readonly name ='hate-score' id='hate-score-id' class='prediction-result1-class'></textarea></div>
        </div>
        <div class="w-col w-col-3">
          <h4 class='prediction-class'>Outcome</h4>
          <div ><textarea readonly name ='outcome-name' id='outcome-id' class='prediction-result-class' ></textarea></div>
        </div>
      </div>
    </div>
  </div>

<!-- footer page  -->
  <div class="section-11 footer wf-section">
    <div class="w-container">
      <div class="w-row">
        <div class="column-4 w-col w-col-4"><img src="static/images/bot.png" width="20" alt="" class="stone-logo footer">
          <div class="footer-text w-hidden-small w-hidden-tiny">Charlie Gong</div>
        </div>
        <div class="column-5 w-col w-col-4">
          <div class="text-block-13">Copyright @ 2022 All rights reserved</div>
        </div>
        <div class="column-6 w-col w-col-4">
          <div class="footer-text address">
              <a class="footer-logo-class" href="mailto:charlie.gong1021@gmail.com"><i id='email-id' class="fa-solid fa-envelope" style="font-size:25px;color:#808080" ></i></a>
              <a class="footer-logo-class" href="#"><i id='wechat-id' class="fa-brands fa-weixin" style="font-size:25px;color:#808080"></i></a>
              <a class="footer-logo-class" href="https://www.instagram.com/carloszjgong/"><i id='ins-id' class="fa-brands fa-instagram" style="font-size:25px;color:#808080"></i></a>
              <a class="footer-logo-class" href="https://www.linkedin.com/in/charlie-gong-8188a11b9/"><i id='linkedin-id' class="fa-brands fa-linkedin" style="font-size:25px;color:#808080"></i></a>
          </div>
        </div>
        <div class="column-7 w-col w-col-4">
          <div id = "wechat_div-id" class="div_wechat_class" >
            <p id="wechat" class="wechat_class"></p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=61b48543ef9d402652170654" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="static/js/webflow.js" type="text/javascript"></script>
  <script>

    function changeTextarea(elementId) {
      let textarea = document.getElementById("selected-topic");
      textarea.innerHTML = document.getElementById(elementId).id;
    }

    $(document).ready(function(){
        $("#reply-comment-div-id").hide();
        $("#wechat_div-id").hide();
        $("#section3-cross_checking-id").hide();

       $('#wechat-id').on('click',function(){
           let weChat = 'Gzjoo1021';
           if($("#wechat_div-id").is(":visible")){
                $("#wechat_div-id").hide();
            } else{
               $("#wechat_div-id").show();
                $('#wechat').textillate({
                in: {
                    effect: 'fadeInDown'
                    },
            });
                $('#wechat').find('.texts li:first').text(weChat);
                $('#wechat').textillate('start');
            }


       });
    $('#democrats-img').on('click',function() {
        var nextSection0_1 = $('#blue-topic');
            $('html, body').animate({
                        scrollTop: nextSection0_1.offset().top +1100
                    }, 1300 );
    });
    $('#republican-img').on('click',function() {
        var nextSection0_2 = $('#red-topic');
            $('html, body').animate({
                        scrollTop: nextSection0_2.offset().top +1100
                    }, 1300 );
    });
        $('#prediction-result-id').hide()
        const reply_comment_list = []
        $('#topic-data-crawling-form-id').on('submit',function() {
            $("#reply-comment-div-id").hide()
            var nextSection1 = $('#sention2-crawled-data');
                     $('html, body').animate({
                        scrollTop: nextSection1.offset().top -300
                    }, 1300 );
            $('#s2-crawled-topic-tbody-id').empty();
            let topic = $('#selected-topic').val();
            let choice = $('#newTopHot-id').val();
            let post_num = $('#Post-Number').val();
            let comment_num = $('#Comment-Number').val();
            let input = {
                'topic': topic,
                'choice': choice,
                'post_num': post_num,
                'comment_num': comment_num
            };
            console.log(input)
            $.ajax({
                url: '/topic_data_crawling',
                type: 'post',
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify(input),
                async: true,
                success: function (return_data,textStatus, jqXHR) {
                    console.log(jqXHR.status)

                    // parse the return_data and plug into the table
                    $('#s2-crawled-topic-id > tbody:last-child').append('<th>TOPIC TITLE</th><th>COMMENT BODY</th>');
                    reply_comment_list.length = 0
                    console.log(reply_comment_list)
                    let comment_idx = 1
                    for (let post in return_data) {
                        let comment_id = ''

                        let comment_arr = return_data[post]
                        for (let comment of comment_arr) {
                           reply_comment_list.push(comment.slice(0,7))

                            $('#s2-crawled-topic-id > tbody:last-child').append("<tr><td>" + post.slice(6,post.length)+ "</td><td>" + comment.slice(7,comment.length)+ "</td><td><input id='reply_comment_id' value='Reply' type='button' class='comment-button'/></td></tr>");
                            $('#reply_comment_id').attr('id',comment.slice(0,7));

                        }

                    }
                    console.log(reply_comment_list)

                    $('#s2-crawled-topic-tbody-id').on('click','input', function(obj) {
                        $('b').empty()
                        console.log(obj.target.id)
                        $("#reply-comment-div-id").show();
                        var nextSection1_2 = $('#reply-comment-div-id');
                        $('html, body').animate({
                            scrollTop: nextSection1_2.offset().top -300
                        }, 1300 );
                        $("#head-id").append('<b id="selected_commentid" class="field-label-2">' + ' ' +obj.target.id + '</b>');

                    });
                    console.log($('b').text())

                },
                error: function(jqXHR,textStatus){
                    var err_msg = '';
                    if (jqXHR.status === 0) {
                        err_msg = 'Not connect.\n Verify Network.';
                    } else if (jqXHR.status == 404) {
                        err_msg = 'Requested page not found. [404]';
                    } else if (jqXHR.status == 500) {
                        err_msg = 'Praw request failed, Internal Server Error [500].';
                    } else if (textStatus === 'parsererror') {
                        err_msg = 'Requested JSON parse failed.';
                    } else if (textStatus === 'timeout') {
                        err_msg = 'Praw request Time out. Please refresh page and try again!';
                    } else if (textStatus === 'abort') {
                        err_msg = 'Ajax request aborted.';
                    } else {
                        err_msg = 'Uncaught Error.\n' + jqXHR.responseText;
                    }
                    alert(err_msg);
                }
            });
        });


        // second ajax request
        $('#cross-checking-form-id').on('submit',function() {

            $('#s3-cross-checking-tbody-id').empty();
            $('#pie-chart-div-id').empty();
            $('#keyword1').find('span').hide();
            $('#keyword2').find('span').hide();
            $('#keyword3').find('span').hide();
            $('#keyword4').find('span').hide();

            let section3_topic = $('#section3-topic-name-id').val();
            let party = $('#section3-political-party-id').val();

            let input = {
                'section3_topic': section3_topic,
                'party': party
            };
            console.log(input)
            $.ajax({
                url: '/cross_checking',
                type: 'post',
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify(input),
                async: true,
                success: function (return_data,textStatus, jqXHR) {
                    $("#section3-cross_checking-id").show();
                    var nextSection2 = $('#section3-cross_checking-id');
                    $('html, body').animate({
                        scrollTop: nextSection2.offset().top -300
                    }, 1300 );
                    console.log(jqXHR.status)
                    if (Object.keys(return_data).length > 1){
                        let return_img_data = (return_data.image_url)[0]
                        console.log(return_img_data)
                        $('#pie-chart-div-id').append('<img id="pie-chart-img-id" src= "" width="500" height="380" >')
                        $("#pie-chart-img-id").attr("src", return_img_data);
                        delete return_data['image_url'];
                        console.log(Object.keys(return_data).length )
                        // parse the return_data and plug into the table
                        $('#s3-cross-checking-table-id > tbody:last-child').append('<th></th><th>POST TITLE</th><th>COMMENT BODY</th>');
                        let redditor = 1;
                        for (let post in return_data) {
                            let redditorId = 'redditor' + redditor.toString()
                            let comment_arr = return_data[post]
                            for (let comment of comment_arr) {
                                console.log(post)
                                console.log(comment)
                                $('#s3-cross-checking-table-id > tbody:last-child').append("<tr><td><input id='redditor' value='Extract Keywords' type='button' class='keyword-button'/></td><td>" + post+ "</td><td>" + comment+ "</td></tr>");
                                $('#redditor').attr('id',redditorId);
                            }
                            redditor += 1;
                        }
                        $('[id="redditor1"]:eq(1)').hide();
                        $('[id="redditor2"]:eq(1)').hide();
                        $('[id="redditor3"]:eq(1)').hide();
                        $('[id="redditor1"]:eq(2)').hide();
                        $('[id="redditor2"]:eq(2)').hide();
                        $('[id="redditor3"]:eq(2)').hide();
                        let topic_party = section3_topic+'_'+party
                        // on click the post name, display the keyword graph
                        $('[id="redditor1"]:eq(0)').on('click', function() {
                            var nextSection2_1 = $('#keyword-div-id');
                            $('html, body').animate({
                                scrollTop: nextSection2_1.offset().top -300
                            }, 1300 );
                            $('#keyword1').find('span').show();
                            $('#keyword2').find('span').show();
                            $('#keyword3').find('span').show();
                            $('#keyword4').find('span').show();
                            $.getJSON('static/datamodel/topic_party.json', function(jd) {
                                let keywordlist1 = jd[topic_party].redditor1
                                console.log(keywordlist1)
                                $('#keyword1').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword1').find('.texts li:first').text(keywordlist1[0][0]);
                                $('#keyword1').textillate('start');
                                $('#keyword2').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword2').find('.texts li:first').text(keywordlist1[1][0]);
                                $('#keyword2').textillate('start');
                                $('#keyword3').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword3').find('.texts li:first').text(keywordlist1[2][0]);
                                $('#keyword3').textillate('start');
                                $('#keyword3').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword4').find('.texts li:first').text(keywordlist1[3][0]);
                                $('#keyword4').textillate('start');
                            });
                        });

                        $('[id="redditor2"]:eq(0)').on('click', function() {
                            var nextSection2_2 = $('#keyword-div-id');
                            $('html, body').animate({
                                scrollTop: nextSection2_2.offset().top -300
                            }, 1300 );
                            $('#keyword1').find('span').show();
                            $('#keyword2').find('span').show();
                            $('#keyword3').find('span').show();
                            $('#keyword4').find('span').show();
                            $.getJSON('static/datamodel/topic_party.json', function(jd) {
                                let keywordlist2 = jd[topic_party].redditor2
                                console.log(keywordlist2)
                                $('#keyword1').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword1').find('.texts li:first').text(keywordlist2[0][0]);
                                $('#keyword1').textillate('start');
                                $('#keyword2').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword2').find('.texts li:first').text(keywordlist2[1][0]);
                                $('#keyword2').textillate('start');
                                $('#keyword3').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword3').find('.texts li:first').text(keywordlist2[2][0]);
                                $('#keyword3').textillate('start');
                                $('#keyword4').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword4').find('.texts li:first').text(keywordlist2[3][0]);
                                $('#keyword4').textillate('start');
                            });
                         });
                         $('[id="redditor3"]:eq(0)').on('click', function() {
                             var nextSection2_3 = $('#keyword-div-id');
                            $('html, body').animate({
                                scrollTop: nextSection2_3.offset().top -300
                            }, 1300 );
                             $('#keyword1').find('span').show();
                            $('#keyword2').find('span').show();
                            $('#keyword3').find('span').show();
                            $('#keyword4').find('span').show();
                            $.getJSON('static/datamodel/topic_party.json', function(jd) {
                                let keywordlist3 = jd[topic_party].redditor3
                                console.log(keywordlist3)
                                $('#keyword1').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword1').find('.texts li:first').text(keywordlist3[0][0]);
                                $('#keyword1').textillate('start');
                                $('#keyword2').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword2').find('.texts li:first').text(keywordlist3[1][0]);
                                $('#keyword2').textillate('start');
                                $('#keyword3').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword3').find('.texts li:first').text(keywordlist3[2][0]);
                                $('#keyword3').textillate('start');
                                $('#keyword4').textillate({
                                    in: {
                                        effect: 'fadeInDown'
                                        },
                                });
                                $('#keyword4').find('.texts li:first').text(keywordlist3[3][0]);
                                $('#keyword4').textillate('start');
                            });
                        });
                        }
                        else {
                            alert("The data you want to cross check doesn't exist, please select another pair")
                        }
                },
                error: function(jqXHR,textStatus){
                    var err_msg = '';
                    if (jqXHR.status === 0) {
                        err_msg = 'Not connect.\n Verify Network.';
                    } else if (jqXHR.status == 404) {
                        err_msg = 'Requested page not found. [404]';
                    } else if (jqXHR.status == 500) {
                        err_msg = 'Praw request failed, Internal Server Error [500].';
                    } else if (textStatus === 'parsererror') {
                        err_msg = 'Requested JSON parse failed.';
                    } else if (textStatus === 'timeout') {
                        err_msg = 'Praw request Time out. Please refresh page and try again!';
                    } else if (textStatus === 'abort') {
                        err_msg = 'Ajax request aborted.';
                    } else {
                        err_msg = 'Uncaught Error.\n' + jqXHR.responseText;
                    }
                    alert(err_msg);
                }
            });
    });

            // Third ajax request
        $('#prediction-form-id').on('submit',function() {


            $('#left-score-id').empty()
            $('#right-score-id').empty()
            $('#hate-score-id').empty()
            $('#outcome-id').empty()
            $('#length-id').empty()
            $('#people-id').empty()
            $('#Noun-Phrases-id').empty()
            $('#hate-severity-id').empty()
            let political_speech = $('#prediction-field-id').val();
            let language = $('#language-id').val();
            let input = {
                'political_speech': political_speech,
                'language': language,
            };
            console.log(input)
            $.ajax({
                url: '/prediction',
                type: 'post',
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify(input),
                async: true,
                success: function (return_data,textStatus, jqXHR) {
                    var nextSection3_3 = $('#text-filtering-id');
                    $('html, body').animate({
                        scrollTop: nextSection3_3.offset().top + 3100
                    }, 1500 );
                    console.log(jqXHR.status)
                    console.log(return_data.democrats)
                    $('#filtered-text-id').textillate({
                        in: {
                            effect: 'splat'
                             },
                     });
                    $('#filtered-text-id').find('.texts li:first').text(return_data.filtered_text);
                    $('#filtered-text-id').textillate('start');
                    $('#prediction-result-id').show()
                    $('#left-score-id').append(return_data.democrats)
                    $('#right-score-id').append(return_data.republicans)
                    $('#hate-score-id').append(return_data.hate)
                    $('#outcome-id').append(return_data.outcome)

                    $('#length-id').append(return_data.word_length)
                    $('#people-id').append(return_data.people)
                    $('#Noun-Phrases-id').append(return_data.noun_phrases)
                    $('#hate-severity-id').append(return_data.abuse_severity)
                },
                error: function(jqXHR,textStatus){
                    var err_msg = '';
                    if (jqXHR.status === 0) {
                        err_msg = 'Not connect.\n Verify Network.';
                    } else if (jqXHR.status == 404) {
                        err_msg = 'Requested page not found. [404]';
                    } else if (jqXHR.status == 500) {
                        err_msg = 'Praw request failed, Internal Server Error [500].';
                    } else if (textStatus === 'parsererror') {
                        err_msg = 'Requested JSON parse failed.';
                    } else if (textStatus === 'timeout') {
                        err_msg = 'Praw request Time out. Please refresh page and try again!';
                    } else if (textStatus === 'abort') {
                        err_msg = 'Ajax request aborted.';
                    } else {
                        err_msg = 'Uncaught Error.\n' + jqXHR.responseText;
                    }
                    alert(err_msg);
                }
            });
    });
        // reply comment ajax request
        $('#reply_comment-form-id').on('submit',function() {
            //alert("your reply has been uodated, check reddit for more information")
            {#let message = return_data[return_message];#}
            {#console.log(message)#}
            let reply_comment_body = $('#reply_comment-field-id').val();
            let comment_id = $('b').text();
            let user_name = $('#username').val()
            let password = $('#pass').val()
            let input = {
                'reply_comment_body': reply_comment_body,
                'comment_id': comment_id,
                'user_name': user_name,
                'password': password
            };
            $.ajax({
                url: '/reply_comments',
                type: 'post',
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify(input),
                async: true,
                success: function (return_data) {

                    console.log("auto-processing")
                },
                error: function(jqXHR,textStatus){
                    var err_msg = '';
                    if (jqXHR.status === 0) {
                        err_msg = 'Not connect.\n Verify Network.';
                    } else if (jqXHR.status == 404) {
                        err_msg = 'Requested page not found. [404]';
                    } else if (jqXHR.status == 500) {
                        err_msg = 'Praw request failed, Internal Server Error [500].';
                    } else if (textStatus === 'parsererror') {
                        err_msg = 'Requested JSON parse failed.';
                    } else if (textStatus === 'timeout') {
                        err_msg = 'Praw request Time out. Please refresh page and try again!';
                    } else if (textStatus === 'abort') {
                        err_msg = 'Ajax request aborted.';
                    } else {
                        err_msg = 'Uncaught Error.\n' + jqXHR.responseText;
                    }
                    alert(err_msg);
                }
            });

        });
    });
  </script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/textillate/0.4.0/jquery.textillate.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lettering.js/0.7.0/jquery.lettering.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.css">
</body>
</html>

